<!doctype html>
<!-- === Coding by CodingLab | www.codinglabweb.com === -->
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <!-- ===== CSS ===== -->
        <link rel="stylesheet" href="css/style.css" />
        <link rel="stylesheet" href="css/upload.css" />
        <!-- ===== Boxicons CSS ===== -->
        <link
            href="https://unpkg.com/boxicons@2.1.1/css/boxicons.min.css"
            rel="stylesheet"
        />
        <script
            src="https://kit.fontawesome.com/fb67a05d46.js"
            crossorigin="anonymous"
        ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
        <title>Programe prix Mr bricolage</title>
    </head>
    <body>
        <!-- From Uiverse.io by andrew-demchenk0 -->

        <div class="info">
            <div class="info__icon">
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    viewBox="0 0 24 24"
                    height="24"
                    fill="none"
                >
                    <path
                        fill="#393a37"
                        d="m12 1.5c-5.79844 0-10.5 4.70156-10.5 10.5 0 5.7984 4.70156 10.5 10.5 10.5 5.7984 0 10.5-4.7016 10.5-10.5 0-5.79844-4.7016-10.5-10.5-10.5zm.75 15.5625c0 .1031-.0844.1875-.1875.1875h-1.125c-.1031 0-.1875-.0844-.1875-.1875v-6.375c0-.1031.0844-.1875.1875-.1875h1.125c.1031 0 .1875.0844.1875.1875zm-.75-8.0625c-.2944-.00601-.5747-.12718-.7808-.3375-.206-.21032-.3215-.49305-.3215-.7875s.1155-.57718.3215-.7875c.2061-.21032.4864-.33149.7808-.3375.2944.00601.5747.12718.7808.3375.206.21032.3215.49305.3215.7875s-.1155.57718-.3215.7875c-.2061.21032-.4864.33149-.7808.3375z"
                    ></path>
                </svg>
            </div>
            <div class="info__title">
                Veuillez t√©l√©charger uniquement un fichier au format .xlsx.
            </div>
            <div class="info__close">
                <svg
                    height="20"
                    viewBox="0 0 20 20"
                    width="20"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <path
                        d="m15.8333 5.34166-1.175-1.175-4.6583 4.65834-4.65833-4.65834-1.175 1.175 4.65833 4.65834-4.65833 4.6583 1.175 1.175 4.65833-4.6583 4.6583 4.6583 1.175-1.175-4.6583-4.6583z"
                        fill="#393a37"
                    ></path>
                </svg>
            </div>
        </div>
        <!-- img backgroud -->
        <img src="img/back.png" />

        <!-- From Uiverse.io by Yaya12085 -->
        <div class="container">
            <div class="header">
                <p>üìÇ! Ÿäÿ±ÿ¨Ÿâ ÿ™ÿµŸÅÿ≠ ŸàÿßÿÆÿ™Ÿäÿßÿ± ŸÖŸÑŸÅ ŸÑŸÑÿ±ŸÅÿπ</p>
                <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                    <g
                        id="SVGRepo_tracerCarrier"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                    ></g>
                    <g id="SVGRepo_iconCarrier">
                        <path
                            d="M7 10V9C7 6.23858 9.23858 4 12 4C14.7614 4 17 6.23858 17 9V10C19.2091 10 21 11.7909 21 14C21 15.4806 20.1956 16.8084 19 17.5M7 10C4.79086 10 3 11.7909 3 14C3 15.4806 3.8044 16.8084 5 17.5M7 10C7.43285 10 7.84965 10.0688 8.24006 10.1959M12 12V21M12 12L15 15M12 12L9 15"
                            stroke="#000000"
                            stroke-width="1.5"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                        ></path>
                    </g>
                </svg>
                <p>Browse File to upload!</p>
            </div>
            <label for="file" class="footer">
                <svg
                    fill="#000000"
                    viewBox="0 0 32 32"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                    <g
                        id="SVGRepo_tracerCarrier"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                    ></g>
                    <g id="SVGRepo_iconCarrier">
                        <path d="M15.331 6H8.5v20h15V14.154h-8.169z"></path>
                        <path d="M18.153 6h-.009v5.342H23.5v-.002z"></path>
                    </g>
                </svg>
                <p>Not selected file</p>
                <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                    <g
                        id="SVGRepo_tracerCarrier"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                    ></g>
                    <g id="SVGRepo_iconCarrier">
                        <path
                            d="M5.16565 10.1534C5.07629 8.99181 5.99473 8 7.15975 8H16.8402C18.0053 8 18.9237 8.9918 18.8344 10.1534L18.142 19.1534C18.0619 20.1954 17.193 21 16.1479 21H7.85206C6.80699 21 5.93811 20.1954 5.85795 19.1534L5.16565 10.1534Z"
                            stroke="#000000"
                            stroke-width="2"
                        ></path>
                        <path
                            d="M19.5 5H4.5"
                            stroke="#000000"
                            stroke-width="2"
                            stroke-linecap="round"
                        ></path>
                        <path
                            d="M10 3C10 2.44772 10.4477 2 11 2H13C13.5523 2 14 2.44772 14 3V5H10V3Z"
                            stroke="#000000"
                            stroke-width="2"
                        ></path>
                    </g>
                </svg>
            </label>
            <input id="file" type="file" name="file" />
        </div>

        <!--- ______code nav bar_________  -->
        <div class="wrapper">
            <input type="checkbox" />
            <div class="fab"></div>
            <div class="fac">
                <a href="prix"
                    ><i
                        class="fas fa-cash-register"
                        style="font-size: 28px"
                    ></i>
                </a>
                <a href="upload"
                    ><i class="far fa-file-excel" style="font-size: 28px"></i
                ></a>
                <a href="logout"
                    ><i class="far fa-file-alt" style="font-size: 28px"></i
                ></a>
            </div>
        </div>
        <div
            id="loadingOverlay"
            style="
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: #000000cc;
                color: white;
                font-size: 24px;
                text-align: center;
                padding-top: 20%;
                z-index: 1000;
            "
        >
            ‚è≥ ÿ¨ÿßÿ±Ÿä ÿ±ŸÅÿπ ÿßŸÑŸÖŸÑŸÅ... <span id="countdown">3</span>
        </div>
        <script>
            const fileInput = document.getElementById("file");
            const loadingOverlay = document.getElementById("loadingOverlay");
            const countdownSpan = document.getElementById("countdown");

            fileInput.addEventListener("change", () => {
                const file = fileInput.files[0];
                if (!file) return alert("Ÿäÿ±ÿ¨Ÿâ ÿßÿÆÿ™Ÿäÿßÿ± ŸÖŸÑŸÅ");

                if (!file.name.endsWith(".xlsx")) {
                    alert("üìÇ ÿßŸÑŸÖÿ±ÿ¨Ÿàÿß ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑŸÖŸÑŸÅÿßÿ™ ÿ®ÿµŸäÿ∫ÿ© .xlsx ŸÅŸÇÿ∑");
                    fileInput.value = "";
                    return;
                }

                // ÿπÿ±ÿ∂ overlay Ÿàÿ®ÿØÿ° ÿßŸÑÿπÿØ ÿßŸÑÿ™ŸÜÿßÿ≤ŸÑŸä (6 ÿ´ŸàÿßŸÜŸä)
                loadingOverlay.style.display = "block";
                let countdown = 3; // ÿπÿØŸÑ ŸáŸÜÿß ÿ≠ÿ≥ÿ® ÿßŸÑŸàŸÇÿ™ ÿßŸÑŸÖÿ™ŸàŸÇÿπ ŸÑŸÑÿ±ŸÅÿπ ŸàÿßŸÑŸÖÿπÿßŸÑÿ¨ÿ©
                countdownSpan.textContent = countdown;

                const interval = setInterval(() => {
                    countdown--;
                    if (countdown > 0) {
                        countdownSpan.textContent = countdown;
                    } else {
                        clearInterval(interval);
                        countdownSpan.textContent = "‚è≥ ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ±ŸÅÿπ...";
                    }
                }, 1000);

                const formData = new FormData();
                formData.append("file", file);

                fetch("/upload", {
                    method: "POST",
                    body: formData
                })
                    .then(res => res.json())
                    .then(data => {
                        console.log("Data received from server:", data);
                        alert("üòç ÿ™ŸÖ ÿ±ŸÅÿπ ÿßŸÑŸÖŸÑŸÅ ÿ®ŸÜÿ¨ÿßÿ≠! üìÇ");
                    })
                    .catch(err => {
                        console.error(err);
                        alert("‚ö†Ô∏è ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑÿ±ŸÅÿπÿå Ÿäÿ±ÿ¨Ÿâ ÿ•ÿπÿßÿØÿ© ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ©.");
                    })
                    .finally(() => {
                        loadingOverlay.style.display = "none";
                    });
            });
        </script>

        <script src="js/main.js"></script>
        <script src="js/codebar.min.js"></script>
    </body>
</html>
